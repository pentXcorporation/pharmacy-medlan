# ==================== APPLICATION ====================
spring.application.name=medlan-pharmacy
server.port=8080
spring.main.allow-bean-definition-overriding=true

# ==================== THYMELEAF CONFIGURATION ====================
spring.thymeleaf.check-template-location=false

# ==================== DATABASE CONFIGURATION (PostgreSQL) ====================
spring.datasource.url=jdbc:postgresql://ep-soft-voice-ah4bk8qm-pooler.c-3.us-east-1.aws.neon.tech/neondb?user=neondb_owner&password=npg_QtoE8KpxlFy4&sslmode=require&channelBinding=require&prepareThreshold=0
spring.datasource.username=neondb_owner
spring.datasource.password=npg_QtoE8KpxlFy4
spring.datasource.driver-class-name=org.postgresql.Driver

# HikariCP Connection Pool Configuration
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.pool-name=MedlanHikariPool

# ==================== JPA/HIBERNATE ====================
# Note: Removed explicit dialect specification as it's auto-detected (fixes HHH90000025 warning)
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# ==================== JWT CONFIGURATION ====================
jwt.secret=${JWT_SECRET:MedlanPharmacySecretKey2024VeryLongSecureKeyForJWTTokenGeneration256Bits}
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# ==================== CORS CONFIGURATION ====================
cors.allowed-origins=https://medlan.vercel.app,http://localhost:3000,http://localhost:5173
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true
cors.max-age=3600

# ==================== SECURITY ====================
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never
server.error.include-exception=false

# ==================== LOGGING ====================
logging.level.root=INFO
logging.level.com.pharmacy.medlan=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# ==================== ACTUATOR ====================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.health.db.enabled=true
management.health.diskspace.enabled=true

# ==================== SWAGGER/OPENAPI ====================
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha

# ==================== FILE UPLOAD ====================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.file-size-threshold=2KB

# ==================== JACKSON ====================
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.time-zone=UTC
spring.jackson.default-property-inclusion=non_null

# ==================== SCHEDULER CONFIGURATION ====================
spring.task.scheduling.pool.size=5

# Cron expressions (24-hour format)
scheduler.low-stock.cron=0 0 7 * * ?
scheduler.expiry.cron=0 0 6 * * ?
scheduler.alert-summary.cron=0 0 8 * * MON
scheduler.notification-cleanup.cron=0 0 0 * * SUN
scheduler.update-expiry-status.cron=0 0 1 * * ?

# ==================== NOTIFICATION CONFIGURATION ====================
notification.email.enabled=false
notification.sms.enabled=false

# Mail Configuration (uncomment and configure for production)
# spring.mail.host=smtp.gmail.com
# spring.mail.port=587
# spring.mail.username=${MAIL_USERNAME}
# spring.mail.password=${MAIL_PASSWORD}
# spring.mail.properties.mail.smtp.auth=true
# spring.mail.properties.mail.smtp.starttls.enable=true
# spring.mail.properties.mail.smtp.connectiontimeout=5000
# spring.mail.properties.mail.smtp.timeout=5000
# spring.mail.properties.mail.smtp.writetimeout=5000

# ==================== CACHE CONFIGURATION ====================
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=600s

# ==================== ASYNC CONFIGURATION ====================
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=medlan-async-

# ==================== BARCODE CONFIGURATION ====================
barcode.default.width=200
barcode.default.height=80
barcode.qr.default.size=200

# ==================== INVENTORY THRESHOLDS ====================
inventory.low-stock.threshold=10
inventory.critical-stock.threshold=5
inventory.expiry-warning.days=90
inventory.expiry-critical.days=30
inventory.expiry-urgent.days=7

# ==================== FRONTEND CONFIGURATION ====================
frontend.url=https://medlan.vercel.app

# ==================== SERVER CONFIGURATION ====================
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css
server.compression.min-response-size=1024
server.http2.enabled=true

# ==================== SPRING BOOT ADMIN (Optional) ====================
# spring.boot.admin.client.url=http://localhost:9090
# spring.boot.admin.client.instance.name=Medlan Pharmacy Backend

# ==================== TRANSACTION MANAGEMENT ====================
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=false

# ==================== DEVELOPMENT TOOLS ====================
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true
spring.devtools.restart.exclude=static/**,public/**

# ==================== PROFILE-SPECIFIC CONFIGURATIONS ====================
# Uncomment to use profile-specific configurations
# spring.profiles.active=dev